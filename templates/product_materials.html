{{define "content"}}
<div class="page-header">
    <h2>Материалы для продукции</h2>
    <a href="/" class="btn btn-secondary">← Назад к списку</a>
</div>

<div class="product-info">
    <h3>{{.product.ProductType.Name}} | {{.product.Name}}</h3>
    <p><strong>Артикул:</strong> {{.product.Article}}</p>
    {{if .product.CalculatedPrice}}
    <p><strong>Расчетная стоимость:</strong> {{printf "%.2f" .product.CalculatedPrice}} ₽</p>
    {{end}}
</div>

{{if .materials}}
<div class="materials-table-container">
    <table class="materials-table">
        <thead>
            <tr>
                <th>Наименование материала</th>
                <th>Артикул</th>
                <th>Количество на единицу</th>
                <th>Стоимость за единицу (₽)</th>
                <th>Общая стоимость (₽)</th>
                <th>Единица измерения</th>
            </tr>
        </thead>
        <tbody>
            {{range .materials}}
            <tr>
                <td class="material-name">{{.Name}}</td>
                <td class="material-article">{{.Article}}</td>
                <td class="material-quantity">{{printf "%.6f" .QuantityPerUnit}}</td>
                <td class="material-cost">{{printf "%.2f" .CostPerUnit}}</td>
                <td class="material-total">{{printf "%.2f" .TotalCost}}</td>
                <td class="material-unit">{{.UnitAbbreviation}}</td>
            </tr>
            {{end}}
        </tbody>
        <tfoot>
            <tr class="total-row">
                <td colspan="4"><strong>Итого:</strong></td>
                <td><strong>
                    {{$total := 0.0}}
                    {{range .materials}}
                        {{$total = add $total .TotalCost}}
                    {{end}}
                    {{printf "%.2f" $total}} ₽
                </strong></td>
                <td></td>
            </tr>
        </tfoot>
    </table>
</div>
{{else}}
<div class="empty-state">
    <p>Для данной продукции не назначены материалы</p>
</div>
{{end}}

<div class="actions">
    <a href="/products/{{.product.ID}}" class="btn btn-info">Детали продукции</a>
    <a href="/products/{{.product.ID}}/edit" class="btn btn-warning">Редактировать продукцию</a>
</div>
{{end}} 